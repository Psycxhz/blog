"use strict";(self["webpackChunk_05"]=self["webpackChunk_05"]||[]).push([[443],{3071:function(e,a,t){t.r(a),t.d(a,{default:function(){return j}});var s=t(8794);function r(e,a,t,r,l,o){const i=(0,s.up)("AddArticle"),n=(0,s.up)("el-tab-pane"),d=(0,s.up)("ArticleManager"),u=(0,s.up)("Phone"),m=(0,s.up)("Phoneall"),c=(0,s.up)("ContactManager"),p=(0,s.up)("el-tabs");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("article",null,[(0,s.Wm)(p,{modelValue:l.activeName,"onUpdate:modelValue":a[0]||(a[0]=e=>l.activeName=e)},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{label:"发表文章",name:"first"},{default:(0,s.w5)((()=>[(0,s.Wm)(i)])),_:1}),(0,s.Wm)(n,{label:"文章管理",name:"second"},{default:(0,s.w5)((()=>[(0,s.Wm)(d)])),_:1}),(0,s.Wm)(n,{label:"相片上传",name:"third"},{default:(0,s.w5)((()=>[(0,s.Wm)(u)])),_:1}),(0,s.Wm)(n,{label:"相册管理",name:"fourth"},{default:(0,s.w5)((()=>[(0,s.Wm)(m)])),_:1}),(0,s.Wm)(n,{label:"反馈收集",name:"fifth"},{default:(0,s.w5)((()=>[(0,s.Wm)(c)])),_:1})])),_:1},8,["modelValue"])])])}function l(e,a,t,r,l,o){return(0,s.wg)(),(0,s.iD)("div",null,"相册管理")}var o={name:"Phoneall"},i=t(8933);const n=(0,i.Z)(o,[["render",l]]);var d=n;function u(e,a,t,r,l,o){return(0,s.wg)(),(0,s.iD)("div",null,"上传照片")}var m={name:"Phone"};const c=(0,i.Z)(m,[["render",u]]);var p=c;const h=e=>((0,s.dD)("data-v-0251e4d6"),e=e(),(0,s.Cn)(),e),w=h((()=>(0,s._)("i",{class:"el-icon-upload"},null,-1))),g=h((()=>(0,s._)("div",{class:"el-upload__text"},[(0,s.Uk)("将文件拖到此处，或"),(0,s._)("em",null,"点击上传")],-1))),f=["src"],_={key:1,class:"el-icon-plus avatar-uploader-icon"},v=(0,s.Uk)("发表文章");function U(e,a,t,r,l,o){const i=(0,s.up)("el-input"),n=(0,s.up)("el-form-item"),d=(0,s.up)("el-upload"),u=(0,s.up)("el-button"),m=(0,s.up)("el-form");return(0,s.wg)(),(0,s.iD)("article",null,[(0,s.Wm)(m,{ref:"articleForm",model:l.articleForm,"label-width":"20px"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{modelValue:l.articleForm.title,"onUpdate:modelValue":a[0]||(a[0]=e=>l.articleForm.title=e),placeholder:"可以自动获取上传的md文件名称"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(n,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{type:"textarea",placeholder:"描述",modelValue:l.articleForm.describe,"onUpdate:modelValue":a[1]||(a[1]=e=>l.articleForm.describe=e)},null,8,["modelValue"])])),_:1}),(0,s.Wm)(n,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,{class:"upload-demo",drag:"",action:`${e.baseURL}/administer/article/md`,"auto-upload":!1,limit:1,"with-credentials":!0,ref:"mdForm","on-change":o.mdChange,"before-remove":o.beforeRemove,"on-success":o.mdUploadSuccess},{default:(0,s.w5)((()=>[w,g])),_:1},8,["action","on-change","before-remove","on-success"])])),_:1}),(0,s.Wm)(n,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,{class:"avatar-uploader",action:e.baseURL+"/administer/article/cover","show-file-list":!1,"auto-upload":!1,"with-credentials":!0,ref:"coverForm","on-change":o.coverChange,"on-success":o.coverUploadSuccess},{default:(0,s.w5)((()=>[l.imageUrl?((0,s.wg)(),(0,s.iD)("img",{key:0,src:l.imageUrl,class:"avatar"},null,8,f)):((0,s.wg)(),(0,s.iD)("i",_))])),_:1},8,["action","on-change","on-success"])])),_:1}),(0,s.Wm)(n,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{type:"primary",onClick:o.submitForm},{default:(0,s.w5)((()=>[v])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])}var b={name:"AddArticle",data(){return{articleForm:{title:"",describe:"",mdUrl:"",coverUrl:""},imageUrl:""}},methods:{mdChange(e,a){console.log(a),"ready"===e.status&&(/^(.+)\.md$/.test(e.name)?this.articleForm.title=RegExp.$1:(this.$message.error("只能上传.md后缀名的文件"),a.pop()))},beforeRemove(e){this.articleForm.title=""},coverChange(e,a){if("ready"===e.status){const t="image/jpeg"===e.raw.type,s=e.raw.size/1024/1024<2;t||this.$message.error("上传头像图片只能是 JPG 格式!"),s||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&s?this.imageUrl=URL.createObjectURL(e.raw):a.pop()}},mdUploadSuccess(e){if(e.code)return this.$message.error(e.message);this.articleForm.mdUrl=e.mdUrl,this.imageUrl?this.$refs.coverForm.submit():this.fromSubmit()},coverUploadSuccess(e){if(console.log(e),e.code)return this.$message.error(e.message);this.articleForm.coverUrl=e.coverUrl,this.fromSubmit()},async fromSubmit(){let{data:e}=await this.$axios({method:"POST",url:"/administer/article/add",data:this.articleForm});this.$router.push(`/article/${e.data.id}`)},submitForm(){this.$refs.mdForm.submit()}}};const y=(0,i.Z)(b,[["render",U],["__scopeId","data-v-0251e4d6"]]);var $=y;const W={class:"article-manager"},k=(0,s.Uk)("点击上传md"),F={style:{display:"flex","justify-content":"space-between","align-items":"center"}},C=(0,s.Uk)("重传封面"),V=(0,s.Uk)(" 修改 "),D=(0,s.Uk)(" 删除 ");function x(e,a,t,r,l,o){const i=(0,s.up)("el-input"),n=(0,s.up)("el-table-column"),d=(0,s.up)("el-button"),u=(0,s.up)("el-upload"),m=(0,s.up)("el-image"),c=(0,s.up)("el-table");return(0,s.wg)(),(0,s.iD)("div",W,[(0,s.Wm)(c,{data:l.allArticleData,style:{width:"100%"}},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{label:"标题",width:"180"},{default:(0,s.w5)((e=>[(0,s.Wm)(i,{modelValue:e.row.title,"onUpdate:modelValue":a=>e.row.title=a},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,s.Wm)(n,{label:"描述",width:"180"},{default:(0,s.w5)((e=>[(0,s.Wm)(i,{modelValue:e.row.describe,"onUpdate:modelValue":a=>e.row.describe=a},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,s.Wm)(n,{label:"重新上传md"},{default:(0,s.w5)((a=>[(0,s.Wm)(u,{class:"upload-demo",action:`${e.baseURL}/administer/article/md`,limit:1,"with-credentials":!0,"on-success":function(e){o.mdUploadSuccess(e,a.row._id)},"before-upload":o.mdBeforeUpload,"show-file-list":!1},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{size:"mini",type:"success"},{default:(0,s.w5)((()=>[k])),_:1})])),_:2},1032,["action","on-success","before-upload"])])),_:1}),(0,s.Wm)(n,{label:"重新上传封面图",width:"180"},{default:(0,s.w5)((a=>[(0,s._)("div",F,[(0,s.Wm)(m,{style:{width:"50px",height:"50px"},src:e.baseURL+a.row.coverUrl,"preview-src-list":[e.baseURL+a.row.coverUrl]},null,8,["src","preview-src-list"]),(0,s.Wm)(u,{class:"upload-demo",action:`${e.baseURL}/administer/article/cover`,limit:1,"with-credentials":!0,"on-success":function(e){o.coverUploadSuccess(e,a.row._id)},"before-upload":o.coverBeforeUpload,"show-file-list":!1},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{size:"mini",type:"warning"},{default:(0,s.w5)((()=>[C])),_:1})])),_:2},1032,["action","on-success","before-upload"])])])),_:1}),(0,s.Wm)(n,{label:"操作"},{default:(0,s.w5)((e=>[(0,s.Wm)(d,{size:"mini",type:"primary",onClick:a=>o.updateArticle(e.row._id,{title:e.row.title,describe:e.row.describe})},{default:(0,s.w5)((()=>[V])),_:2},1032,["onClick"]),(0,s.Wm)(d,{size:"mini",type:"danger",onClick:a=>o.deleteArticle(e.row._id)},{default:(0,s.w5)((()=>[D])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])}var S={name:"ArticleManager",data(){return{allArticleData:[]}},methods:{async getArticles(){let{data:e}=await this.$axios({method:"GET",url:"/get/article"});if(e.code)return this.$message.error(e.message);this.allArticleData=e.data},mdBeforeUpload(e){let a=/^(.+)\.md$/.test(e.name);if(a)return!0;this.$message.error("只能上传.md后缀名的文件")},mdUploadSuccess(e,a){if(e.code)return this.$message.error(e.message);this.updateArticle(a,{mdUrl:e.mdUrl})},coverBeforeUpload(e){if("ready"===e.status){const a="image/jpeg"===e.raw.type,t=e.raw.size/1024/1024<2;return a||this.$message.error("上传头像图片只能是 JPG 格式!"),t||this.$message.error("上传头像图片大小不能超过 2MB!"),a&&t}},coverUploadSuccess(e,a){if(console.log(e),e.code)return this.$message.error(e.message);this.updateArticle(a,{coverUrl:e.coverUrl})},async updateArticle(e,a){await this.$axios({method:"POST",url:"/administer/article/update",data:{id:e,doc:a}}),this.getArticles()},async deleteArticle(e){let{data:a}=await this.$axios({method:"DELETE",url:"/administer/article/delete",data:{id:e}});this.getArticles()}},created(){this.getArticles()}};const A=(0,i.Z)(S,[["render",x]]);var I=A,P=t(4138);function R(e,a,t,r,l,o){const i=(0,s.up)("el-table-column"),n=(0,s.up)("el-switch"),d=(0,s.up)("el-table");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(d,{data:l.contactData,style:{width:"100%"}},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{label:"日期",width:"180"},{default:(0,s.w5)((e=>[(0,s._)("span",null,(0,P.zw)(new Date(e.row.date).toLocaleString()),1)])),_:1}),(0,s.Wm)(i,{prop:"name",label:"名称",width:"180"}),(0,s.Wm)(i,{prop:"email",label:"Email"}),(0,s.Wm)(i,{prop:"message",label:"内容"}),(0,s.Wm)(i,{label:"是否处理"},{default:(0,s.w5)((e=>[(0,s.Wm)(n,{style:{display:"block"},modelValue:e.row.reading,"onUpdate:modelValue":a=>e.row.reading=a,"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"已阅读","inactive-text":"未阅读",onChange:a=>o.switchState(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1})])),_:1},8,["data"])])}var z={name:"ContactManager",data(){return{contactData:[]}},methods:{async getContactData(){let{data:e}=await this.$axios({method:"GET",url:"/get/getcontact"});e.code||(this.contactData=e.data)},async switchState(e){let{data:a}=await this.$axios({method:"POST",url:"/contact/update",data:{id:e._id,reading:e.reading}});if(a.code)return this.$message.error("状态修改失败");this.getContactData()}},created(){this.getContactData()}};const E=(0,i.Z)(z,[["render",R]]);var L=E,M={name:"Admin",data(){return{activeName:"first"}},components:{Phoneall:d,Phone:p,AddArticle:$,ArticleManager:I,ContactManager:L},methods:{async isCheck(){let{data:e}=await this.$axios({method:"POST",url:"/administer/isCheck"});e.code?(this.$router.replace("/"),this.$message.error(e.message)):this.$message.success(e.message)}},created(){this.isCheck()}};const Z=(0,i.Z)(M,[["render",r],["__scopeId","data-v-2002ea5d"]]);var j=Z},6926:function(e,a,t){t.r(a),t.d(a,{default:function(){return u}});var s=t(8794);const r={class:"album"},l={class:"demo-image__preview"};function o(e,a,t,o,i,n){const d=(0,s.up)("el-image");return(0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.phoneAll,((a,t)=>((0,s.wg)(),(0,s.iD)("li",{key:a._id},[(0,s._)("div",l,[(0,s.Wm)(d,{style:{width:"100px",height:"100px"},src:`${e.baseURL}${a.imgUrl}`,"preview-src-list":i.phoneurl,"initial-index":0,fit:"cover"},null,8,["src","preview-src-list"])])])))),128))])])}var i={name:"Album",data(){return{phoneAll:[],phoneurl:[]}},methods:{async getphone(){let{data:e}=await this.$axios({method:"GET",url:"/get/phone"});if(e.code)return this.$message.error(e.message);console.log(e.data),this.phoneAll=e.data,this.phoneAll.forEach((e=>{this.phoneurl.push(this.baseURL+e.imgUrl)}))}},created(){this.getphone()}},n=t(8933);const d=(0,n.Z)(i,[["render",o],["__scopeId","data-v-6a87edea"]]);var u=d},2885:function(e,a,t){t.r(a),t.d(a,{default:function(){return _}});var s=t(8794),r=t(4138);const l={class:"all-article"},o={class:"date"},i={class:"day"},n={class:"month-year"},d={class:"article-content"},u=["src"],m={class:"describe"},c={class:"other"},p=(0,s.Uk)("点击阅读");function h(e,a,t,h,w,g){const f=(0,s.up)("router-link"),_=(0,s.Q2)("infinite-scroll");return(0,s.wg)(),(0,s.iD)("div",l,[(0,s.wy)(((0,s.wg)(),(0,s.iD)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(w.pageArticleData,(a=>((0,s.wg)(),(0,s.iD)("li",{key:a._id},[(0,s._)("header",null,[(0,s._)("h2",null,(0,r.zw)(a.title),1),(0,s._)("div",o,[(0,s._)("p",i,(0,r.zw)(new Date(a.date).getDate()),1),(0,s._)("p",n,[(0,s._)("span",null,(0,r.zw)(new Date(a.date).getMonth()+1),1),(0,s._)("span",null,(0,r.zw)(new Date(a.date).getFullYear()),1)])]),(0,s._)("div",d,[(0,s._)("img",{src:e.baseURL+a.coverUrl,alt:""},null,8,u),(0,s._)("p",m,(0,r.zw)(a.describe),1)]),(0,s._)("div",c,[(0,s._)("p",null,"阅读数："+(0,r.zw)(a.readingNum),1),(0,s.Wm)(f,{to:`/article/${a._id}`},{default:(0,s.w5)((()=>[p])),_:2},1032,["to"])])])])))),128))])),[[_,g.load]])])}var w={name:"Article",data(){return{pageArticleData:[],allArticleData:[],skip:5}},methods:{async getArticles(){let{data:e}=await this.$axios({method:"GET",url:"/get/article"});if(e.code)return this.$message.error(e.message);this.allArticleData=e.data,this.pageArticleData.push(...this.allArticleData.slice(0,this.skip))},load(){}},created(){this.getArticles()}},g=t(8933);const f=(0,g.Z)(w,[["render",h],["__scopeId","data-v-638a2a4c"]]);var _=f},6429:function(e,a,t){t.r(a),t.d(a,{default:function(){return z}});var s=t(8794),r=t(4138),l=t(5077);const o=e=>((0,s.dD)("data-v-f1e03b6c"),e=e(),(0,s.Cn)(),e),i={class:"about"},n=o((()=>(0,s._)("h2",null,"请输入你的回复",-1))),d={class:"publish"},u={class:"emojix-box"},m={class:"emoji"},c=["onClick"],p=(0,s.Uk)("发表留言"),h={class:"comment-area"},w={class:"comment-wrap"},g=["src"],f={class:"message-box"},_={class:"name-time"},v={class:"text"},U={class:"like-reply"},b=["onClick"],y=["onClick"],$=["src"],W={class:"message-box"},k={class:"name-time"},F={class:"text"},C={class:"like-reply"},V=["onClick"],D=["onClick"],x=(0,s.Uk)("提交回复");function S(e,a,t,o,S,A){const I=(0,s.up)("el-input"),P=(0,s.up)("el-button");return(0,s.wg)(),(0,s.iD)("div",i,[(0,s._)("article",null,[n,(0,s.Wm)(I,{modelValue:S.textarea,"onUpdate:modelValue":a[0]||(a[0]=e=>S.textarea=e),rows:1,placeholder:"请输入内容",type:"textarea"},null,8,["modelValue"]),(0,s._)("div",d,[(0,s._)("div",u,[(0,s._)("i",{class:"iconfont icon-biaoqing",onClick:a[1]||(a[1]=(...e)=>A.showEmoji&&A.showEmoji(...e))}),(0,s.wy)((0,s._)("div",m,[(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(S.arrEmoji,((e,a)=>((0,s.wg)(),(0,s.iD)("li",{key:a,onClick:a=>A.printEmoji(e)},(0,r.zw)(e),9,c)))),128))])],512),[[l.F8,S.isShow]])]),(0,s.Wm)(P,{type:"primary",size:"mini",onClick:A.submit},{default:(0,s.w5)((()=>[p])),_:1},8,["onClick"])])]),(0,s._)("article",h,[(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(S.arrMessage,(a=>((0,s.wg)(),(0,s.iD)("li",{key:a.id},[(0,s._)("div",w,[(0,s._)("img",{src:`${e.baseURL}${a.author.img}`},null,8,g),(0,s._)("div",f,[(0,s._)("div",_,[(0,s._)("span",null,(0,r.zw)(a.author.user),1),(0,s._)("span",null,(0,r.zw)(A.formatDate(a.data)),1)]),(0,s._)("p",v,(0,r.zw)(a.content),1),(0,s._)("div",U,[(0,s._)("i",{class:(0,r.C_)(["iconfont icon-xinaixin",{red:e.userInfo._id&&a.likes.includes(e.userInfo._id)}]),onClick:e=>A.commentLikes(a._id)},null,10,b),(0,s._)("span",null,(0,r.zw)(a.likes.length),1),(0,s._)("i",{class:"iconfont icon-huifu",onClick:e=>A.commentReply(a)},null,8,y)])])]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.children,((t,l)=>((0,s.wg)(),(0,s.iD)("div",{class:"reply-wrap",key:t._id},[(0,s._)("img",{src:`${e.baseURL}${t.author.img}`},null,8,$),(0,s._)("div",W,[(0,s._)("div",k,[(0,s._)("span",null,(0,r.zw)(t.author.name),1),(0,s._)("span",null,(0,r.zw)(A.formatDate(t.data)),1)]),(0,s._)("p",F,[(0,s._)("span",null,"@"+(0,r.zw)(t.replyUser.name),1),(0,s.Uk)((0,r.zw)(t.content),1)]),(0,s._)("div",C,[(0,s._)("i",{class:(0,r.C_)(["iconfont icon-xinaixin",{red:e.userInfo._id&&t.likes.includes(e.userInfo._id)}]),onClick:e=>A.replayLikes(a._id,t._id,l)},null,10,V),(0,s._)("span",null,(0,r.zw)(t.likes.length),1),(0,s._)("i",{class:"iconfont icon-huifu",onClick:e=>A.childReply(a,t)},null,8,D)])])])))),128)),(0,s._)("div",{class:(0,r.C_)(["print-reply",{show:a.isShowReply}])},[(0,s.Wm)(I,{size:"mini",modelValue:a.replyContent,"onUpdate:modelValue":e=>a.replyContent=e,placeholder:`@${a.replyUser.name}`},null,8,["modelValue","onUpdate:modelValue","placeholder"]),(0,s.Wm)(P,{type:"primary",size:"mini",onClick:e=>A.submitReply(a)},{default:(0,s.w5)((()=>[x])),_:2},1032,["onClick"])],2)])))),128))])])])}var A=t(8547),I={name:"Message",data(){return{textarea:"",isShow:!1,arrEmoji:["😃","😁","😂","😊","🙃","🥰","😘","🤭","🤔","😏","😵","😟","🙁","😳","😰","😭","😖","😡","😠","😈","🤡","☠️","👻","🙈","🙉","❤️","💖","💢","💣","💤","👋","👍","👌","🤞","🤟","🤙","👊","🖕","🤝","🙏","🙅","🙅‍♂️","👨‍✈️","👩‍✈️","👷","👷‍♀️","🤦","🤦‍♂️","👴","🧓","🐴","🐮","🐖","🐑","🐓","🦚","🐲","🐳","🐟","🐌"],arrMessage:[]}},computed:{...(0,A.rn)(["userInfo"])},methods:{formatDate(e){let a=new Date(parseInt(e)),t=a.getFullYear(),s=a.getMonth()+1,r=a.getDate(),l=a.getHours(),o=a.getMinutes(),i=a.getSeconds();return`${t}-${s}-${r} ${l}:${o}:${i}`},async commentLikes(e){if(!this.userInfo.name)return this.$message.error("请登录，登录后才能发表留言哦！");let{data:a}=await this.$axios({method:"POST",url:"/likes/comment",data:{id:e}});if(a.code)return this.$message.error(a.message);this.getMessage()},async commentReply(e){if(!this.userInfo.name)return this.$message.error("请登录，登录后才能发表留言哦！");e.author._id!==e.replyUser._id?e.isShowReply=!0:e.isShowReply=!e.isShowReply,e.replyUser=e.author},submit(){if(!this.userInfo.name)return this.$message.error("请登录，登录后才能发表留言哦！");let e=this.textarea.trim();this.$axios({method:"POST",url:"/publish",data:{valMsg:e}}).then((e=>{if(console.log(e),e.data.code)return this.$message.error(e.data.message);this.$message.success(e.data.message),this.getMessage(),this.textarea=""}))},async getMessage(){let{data:e}=await this.$axios({method:"GET",url:"/get/msg"});e.data.forEach((e=>{e.isShowReply=!1,e.replyContent="",e.replyUser=e.author})),this.arrMessage=e.data},async commentReply(e){if(!this.userInfo.name)return this.$message.error("请登录，登录后才能发表留言哦！");e.author._id!==e.replyUser._id?e.isShowReply=!0:e.isShowReply=!e.isShowReply,e.replyUser=e.author},childReply(e,a){if(!this.userInfo.name)return this.$message.error("请登录，登录后才能发表留言哦！");a.author._id!==e.replyUser._id?e.isShowReply=!0:e.isShowReply=!e.isShowReply,e.replyUser=a.author},async replayLikes(e,a,t){if(!this.userInfo.name)return this.$message.error("请登录，登录后才能发表留言哦！");let{data:s}=await this.$axios({method:"POST",url:"/like/replay",data:{parentId:e,childId:a,childIndex:t}});if(s.code)return this.$message.error(s.message);this.getMessage()},async submitReply(e){if(!this.userInfo.name)return this.$message.error("请登录，登录后才能发表留言哦！");let a=e.replyContent.trim();if(!a)return this.$message.error("请输入回复的内容！");if(a.length>100)return this.$message.error("字数不能超过100");let{data:t}=await this.$axios({method:"POST",url:"/reply/submit",data:{id:e._id,content:a,replyUser:e.replyUser._id}});if(t.code)return this.$message.error(t.message);this.$message.success(t.message),this.getMessage()},showEmoji(){this.isShow=!this.isShow},printEmoji(e){this.textarea.length>=99||(this.textarea+=e)}},created(){this.getMessage()}},P=t(8933);const R=(0,P.Z)(I,[["render",S],["__scopeId","data-v-f1e03b6c"]]);var z=R},4389:function(e,a,t){t.r(a),t.d(a,{default:function(){return N}});var s=t(8794);function r(e,a,t,r,l,o){const i=(0,s.up)("Updatauser"),n=(0,s.up)("Longin");return e.userInfo.name?((0,s.wg)(),(0,s.j4)(i,{key:0})):((0,s.wg)(),(0,s.j4)(n,{key:1}))}const l={key:0,class:"dialog"},o={class:"content"},i=(0,s.Uk)("登录"),n=(0,s.Uk)("注册");function d(e,a,t,r,d,u){const m=(0,s.up)("el-input"),c=(0,s.up)("el-form-item"),p=(0,s.up)("el-button"),h=(0,s.up)("el-form"),w=(0,s.up)("el-tab-pane"),g=(0,s.up)("el-tabs");return d.show?((0,s.wg)(),(0,s.iD)("div",l,[(0,s._)("div",o,[(0,s.Wm)(g,{modelValue:d.activeName,"onUpdate:modelValue":a[5]||(a[5]=e=>d.activeName=e)},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{label:"登录",name:"first"},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{model:d.loginForm,rules:d.rules,ref:"loginForm","label-width":"100px"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{label:"用户名",prop:"user"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{modelValue:d.loginForm.user,"onUpdate:modelValue":a[0]||(a[0]=e=>d.loginForm.user=e)},null,8,["modelValue"])])),_:1}),(0,s.Wm)(c,{label:"密码",prop:"password"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{type:"password",modelValue:d.loginForm.password,"onUpdate:modelValue":a[1]||(a[1]=e=>d.loginForm.password=e)},null,8,["modelValue"])])),_:1}),(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(p,{type:"primary",onClick:u.loginSubmit},{default:(0,s.w5)((()=>[i])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1}),(0,s.Wm)(w,{label:"注册",name:"second"},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{model:d.regForm,rules:d.rules,ref:"regForm","label-width":"100px"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{label:"用户名",prop:"user"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{modelValue:d.regForm.user,"onUpdate:modelValue":a[2]||(a[2]=e=>d.regForm.user=e)},null,8,["modelValue"])])),_:1}),(0,s.Wm)(c,{label:"密码",prop:"password"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{type:"password",modelValue:d.regForm.password,"onUpdate:modelValue":a[3]||(a[3]=e=>d.regForm.password=e)},null,8,["modelValue"])])),_:1}),(0,s.Wm)(c,{label:"确认密码",prop:"password2"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{type:"password",modelValue:d.regForm.password2,"onUpdate:modelValue":a[4]||(a[4]=e=>d.regForm.password2=e)},null,8,["modelValue"])])),_:1}),(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(p,{type:"primary",onClick:u.regSubmit},{default:(0,s.w5)((()=>[n])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1},8,["modelValue"])])])):(0,s.kq)("",!0)}t(6422);var u=t(8547),m={name:"Login",data(){return{show:!0,activeName:"first",regForm:{user:"",password:"",password2:""},loginForm:{user:"",password:""},rules:{user:[{required:!0,message:"请输入用户名"},{validator(e,a,t){a.length<2||a.length>8?t(new Error("请输入2-8位字符")):/^[a-zA-Z0-9_\u4e00-\u9fa5]+$/.test(a)?t():t(new Error("只允许汉字、字母、下划线"))}}],password:[{required:!0,message:"请输入密码"},{validator(e,a,t){a.length<6||a.length>18?t(new Error("请输入6-18位字符")):/^[a-zA-Z]\w{5,17}$/.test(a)?t():t(new Error("以字母开头,只能包含字符、数字和下划线"))}}],password2:[{required:!0,message:"请确认密码"},{validator:(e,a,t)=>{this.regForm.password===a?t():t(new Error("两次密码不一致"))}}]}}},computed:{...(0,u.rn)(["userInfo"])},methods:{hide(){this.userInfo.name?this.show=!1:this.show=!0},regSubmit(){this.$refs.regForm.validate((async e=>{if(!e)return!1;{let{data:e}=await this.$axios({method:"POST",url:"/sing",data:{user:this.regForm.user,password:this.regForm.password}});e.cors?this.$message.error(e.message):(this.$message.success("注册成功"),this.activeName="first",this.$refs.regForm.resetFields())}}))},loginSubmit(){this.$refs.loginForm.validate((async e=>{if(!e)return!1;{let{data:e}=await this.$axios({method:"POST",url:"/long",data:this.loginForm});e.cors?this.$message.error(e.massage):(this.$message.success("登录成功"),this.$refs.regForm.resetFields(),this.show=!1,this.updateUserInfo(e.data[0]))}}))},...(0,u.OI)(["updateUserInfo"])},created(){this.hide()}},c=t(8933);const p=(0,c.Z)(m,[["render",d],["__scopeId","data-v-63045f4c"]]);var h=p;const w=e=>((0,s.dD)("data-v-4a8e5f20"),e=e(),(0,s.Cn)(),e),g={class:"update-info"},f=w((()=>(0,s._)("h2",null,"修改用户名",-1))),_=w((()=>(0,s._)("h2",null,"修改密码",-1))),v=w((()=>(0,s._)("h2",null,"头像上传",-1)));function U(e,a,t,r,l,o){const i=(0,s.up)("UserName"),n=(0,s.up)("UserPassword"),d=(0,s.up)("UserHeadimg");return(0,s.wg)(),(0,s.iD)("div",g,[(0,s._)("article",null,[f,(0,s.Wm)(i)]),(0,s._)("article",null,[_,(0,s.Wm)(n)]),(0,s._)("article",null,[v,(0,s.Wm)(d)])])}var b=t(4138);const y=(0,s.Uk)("立即修改");function $(e,a,t,r,l,o){const i=(0,s.up)("el-form-item"),n=(0,s.up)("el-input"),d=(0,s.up)("el-button"),u=(0,s.up)("el-form");return(0,s.wg)(),(0,s.j4)(u,{ref:"userFrom",model:l.userFrom,"label-width":"100px",rules:l.rules},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{label:"当前用户名"},{default:(0,s.w5)((()=>[(0,s._)("span",null,(0,b.zw)(e.userInfo.name),1)])),_:1}),(0,s.Wm)(i,{label:"新的用户名",prop:"user"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{modelValue:l.userFrom.user,"onUpdate:modelValue":a[0]||(a[0]=e=>l.userFrom.user=e)},null,8,["modelValue"])])),_:1}),(0,s.Wm)(i,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,{type:"primary",onClick:o.onSubmit},{default:(0,s.w5)((()=>[y])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])}var W={name:"UserName",data(){return{userFrom:{user:""},rules:{user:[{validator:(e,a,t)=>{a.length<2||a.length>8?t(new Error("请输入2-8位用户名")):(/^[a-zA-Z0-9_\u4e00-\u9fa5]+$/.test(a)||t(new Error("只允许汉字、字母、下划线")),a===this.userInfo.name?t(new Error("不能修改为原来的名称")):t())}}]}}},computed:{...(0,u.rn)(["userInfo"])},methods:{...(0,u.OI)(["updateUserInfo"]),onSubmit(){this.$refs.userInfo.validator((async e=>{if(e){let{data:e}=await this.$axios({method:"POST",url:"/upname",data:{user:this.userInfo.user}});if(console.log(e),e.code)return this.$message.error(e.message);this.$message.success(e.message),this.updateUserInfo(e.data),this.$refs.userFrom.resetFields()}}))}}};const k=(0,c.Z)(W,[["render",$],["__scopeId","data-v-0b015ee1"]]);var F=k;const C=(0,s.Uk)("立即修改");function V(e,a,t,r,l,o){const i=(0,s.up)("el-input"),n=(0,s.up)("el-form-item"),d=(0,s.up)("el-button"),u=(0,s.up)("el-form");return(0,s.wg)(),(0,s.j4)(u,{ref:"passForm",model:l.passForm,"label-width":"100px",rules:l.rules},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{label:"旧密码",prop:"oldPassword"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{type:"password",modelValue:l.passForm.oldPassword,"onUpdate:modelValue":a[0]||(a[0]=e=>l.passForm.oldPassword=e)},null,8,["modelValue"])])),_:1}),(0,s.Wm)(n,{label:"新密码",prop:"newPassword"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{type:"password",modelValue:l.passForm.newPassword,"onUpdate:modelValue":a[1]||(a[1]=e=>l.passForm.newPassword=e)},null,8,["modelValue"])])),_:1}),(0,s.Wm)(n,{label:"确认密码",prop:"newPassword2"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{type:"password",modelValue:l.passForm.newPassword2,"onUpdate:modelValue":a[2]||(a[2]=e=>l.passForm.newPassword2=e)},null,8,["modelValue"])])),_:1}),(0,s.Wm)(n,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,{type:"primary",onClick:o.onSubmit},{default:(0,s.w5)((()=>[C])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])}var D={name:"UserPassword",data(){return{passForm:{oldPassword:"",newPassword:"",newPassword2:""},rules:{oldPassword:[{validator(e,a,t){a.length<6||a.length>18?t(new Error("请输入6-18位字符")):/^[a-zA-Z]\w{5,17}$/.test(a)?t():t(new Error("以字母开头,只能包含字符、数字和下划线"))}}],newPassword:[{validator(e,a,t){a.length<6||a.length>18?t(new Error("请输入6-18位字符")):/^[a-zA-Z]\w{5,17}$/.test(a)?t():t(new Error("以字母开头,只能包含字符、数字和下划线"))}}],newPassword2:[{validator:(e,a,t)=>{this.passForm.newPassword===a?t():t(new Error("确认密码与新密码不一致"))}}]}}},computed:{...(0,u.rn)(["userInfo"])},methods:{...(0,u.OI)(["clearUserInfo"]),onSubmit(){this.$refs.passForm.validate((e=>{if(!e)return!1;this.$axios({method:"POST",url:"/uppass",data:{oldPassword:this.passForm.oldPassword,newPassword:this.passForm.newPassword}}).then((e=>{let{data:a}=e;if(a.code)return this.$message.error(a.message);this.$message.success(a.message),this.clearUserInfo(),this.$refs.passForm.resetFields(),this.$router.push("/")}))}))}}};const x=(0,c.Z)(D,[["render",V],["__scopeId","data-v-79984275"]]);var S=x;const A=["src"],I={key:1,class:"el-icon-plus avatar-uploader-icon"},P=(0,s.Uk)("上传");function R(e,a,t,r,l,o){const i=(0,s.up)("el-upload"),n=(0,s.up)("el-button");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(i,{class:"avatar-uploader",action:e.baseURL+"/head",name:"header","show-file-list":!1,"with-credentials":!0,"on-success":o.handleAvatarSuccess,"before-upload":o.beforeAvatarUpload},{default:(0,s.w5)((()=>[l.imageUrl?((0,s.wg)(),(0,s.iD)("img",{key:0,src:l.imageUrl,class:"avatar"},null,8,A)):((0,s.wg)(),(0,s.iD)("i",I))])),_:1},8,["action","on-success","before-upload"]),(0,s.Wm)(n,{type:"success",size:"mini",onClick:o.upload},{default:(0,s.w5)((()=>[P])),_:1},8,["onClick"])],64)}var z={name:"UserHeadimg",data(){return{imageUrl:""}},methods:{beforeAvatarUpload(e){const a="image/jpeg"===e.type,t=e.size/1024/1024<2;return a||this.$message.error("上传头像图片只能是 JPG 格式!"),t||this.$message.error("上传头像图片大小不能超过 2MB!"),a&&t},handleAvatarSuccess(e,a){if(e.code)return this.$message.error(e.message);this.imageUrl=URL.createObjectURL(a.raw)},upload(){if(console.log(1),!this.imageUrl)return this.$message.error("请选择图片");this.$axios({method:"POST",url:"/headimg"}).then((e=>{this.updateuserImg(e.data),this.imageUrl=""}))}}};const E=(0,c.Z)(z,[["render",R],["__scopeId","data-v-b1401df2"]]);var L=E,M={name:"Updatauser",components:{UserName:F,UserPassword:S,UserHeadimg:L}};const Z=(0,c.Z)(M,[["render",U],["__scopeId","data-v-4a8e5f20"]]);var j=Z,T={name:"Userdata",components:{Longin:h,Updatauser:j},computed:{...(0,u.rn)(["userInfo"])}};const O=(0,c.Z)(T,[["render",r]]);var N=O}}]);
//# sourceMappingURL=about.5d69d09e.js.map